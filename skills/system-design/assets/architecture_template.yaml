# System Design Architecture Template
# Scalable web application architecture

system:
  name: scalable-web-app
  version: 1.0.0

components:
  load_balancer:
    type: ALB
    config:
      scheme: internet-facing
      health_check:
        path: /health
        interval: 30
        timeout: 5
      sticky_sessions: false
      ssl_termination: true

  web_tier:
    type: auto_scaling_group
    instances:
      min: 2
      max: 10
      desired: 3
    instance_type: t3.medium
    scaling_policy:
      metric: cpu_utilization
      target: 70
      scale_in_cooldown: 300
      scale_out_cooldown: 60

  api_tier:
    type: containerized
    orchestration: ECS_Fargate
    services:
      - name: user-service
        cpu: 256
        memory: 512
        replicas: 3
      - name: order-service
        cpu: 512
        memory: 1024
        replicas: 2

  cache:
    type: Redis
    service: ElastiCache
    node_type: cache.r6g.large
    num_nodes: 2
    strategy: write_through
    ttl_default: 3600

  database:
    primary:
      type: PostgreSQL
      service: RDS
      instance_class: db.r6g.xlarge
      multi_az: true
      storage:
        type: gp3
        size: 500
        iops: 3000
    read_replicas:
      count: 2
      instance_class: db.r6g.large

  message_queue:
    type: SQS
    queues:
      - name: order-processing
        visibility_timeout: 300
        dlq_enabled: true
        dlq_max_receives: 3

  cdn:
    type: CloudFront
    origins:
      - s3://static-assets
      - alb://api
    ttl:
      static: 86400
      dynamic: 0

  storage:
    static_assets:
      type: S3
      versioning: true
      lifecycle:
        - transition_to_ia: 30
        - transition_to_glacier: 90
    user_uploads:
      type: S3
      encryption: AES256
      max_file_size: 10MB

monitoring:
  metrics:
    service: CloudWatch
    custom_metrics:
      - orders_per_minute
      - api_latency_p99
      - cache_hit_rate

  logging:
    aggregation: CloudWatch_Logs
    retention_days: 30
    format: json

  tracing:
    service: X-Ray
    sampling_rate: 0.05

  alerting:
    channels:
      - sns_topic
      - pagerduty
    rules:
      - name: high_error_rate
        metric: error_rate
        threshold: 0.01
        period: 300

security:
  network:
    vpc_cidr: 10.0.0.0/16
    public_subnets: 2
    private_subnets: 2
    nat_gateways: 2

  waf:
    enabled: true
    rules:
      - sql_injection
      - xss
      - rate_limiting

  secrets:
    service: Secrets_Manager
    rotation: enabled
    rotation_days: 30

disaster_recovery:
  rto: 4_hours
  rpo: 1_hour
  strategy: pilot_light
  backup:
    database: daily
    retention: 30_days
    cross_region: true
